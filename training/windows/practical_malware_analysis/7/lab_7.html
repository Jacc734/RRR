<!DOCTYPE HTML>

<html>
<head>
  <meta charset="utf-8">
  <!-- Include required JS files -->
  <script type="text/javascript" src="../template/syntaxhighlighter_3.0.83/js/shCore.js"></script>
  <!-- At least one brush -->
  <script type="text/javascript" src="../template/syntaxhighlighter_3.0.83/js/langs/shBrushPython.js"></script>
  <script type="text/javascript" src="../template/syntaxhighlighter_3.0.83/js/langs/shBrushNasm8086.js"></script>
  <script type="text/javascript" src="../template/syntaxhighlighter_3.0.83/js/langs/shBrushCpp.js"></script>
  <script type="text/javascript" src="../template/syntaxhighlighter_3.0.83/js/langs/shBrushBash.js"></script>
  <script type="text/javascript" src="../template/syntaxhighlighter_3.0.83/js/langs/shBrushDiff.js"></script>
  <!-- Include *at least* the core style and default theme -->
  <link href="../template/syntaxhighlighter_3.0.83/css/shCore.css" rel="stylesheet" type="text/css" />
  <link href="../template/syntaxhighlighter_3.0.83/css/shThemeDefault.css" rel="stylesheet" type="text/css" />
  <!-- My styles -->
  <link href="../template/css/my_styles.css" rel="stylesheet" type="text/css" />
</head>

<body>

<h1>LAB 7-1</h1>
<h3>Analyze the malware found in the file Lab07-01.exe. Radare2 and IDA Pro will be used whenever it's suitable.</h3>

<div class="question-container">
  <div class="question">1. How does this program ensure that it continues running (achieves per- sistence) when the computer is restarted?</div>
  <div class="answer">
        pass
  </div>
</div>

<div class="question-container">
  <div class="question">2. Why does this program use a mutex?</div>
  <div class="answer">
  </div>
</div>

<div class="question-container">
  <div class="question">3. What is a good host-based signature to use for detecting this program?</div>
  <div class="answer">
  </div>
</div>

<div class="question-container">
  <div class="question">4. What is a good network-based signature for detecting this malware?</div>
  <div class="answer">
  </div>
</div>

<div class="question-container">
  <div class="question">5. What is the purpose of this program?</div>
  <div class="answer">
  </div>
</div>

<div class="question-container">
  <div class="question">6. When will this program finish executing?</div>
  <div class="answer">
  </div>
</div>

<h1>LAB 7-2</h1>
<h3>Analyze the malware found in the file Lab07-02.exe. Radare2 and IDA Pro will be used whenever it's suitable.</h3>


<div class="question-container">
  <div class="question">1. How does this program achieve persistence?</div>
  <div class="answer">
  </div>
</div>

<div class="question-container">
  <div class="question">2. What is the purpose of this program?</div>
  <div class="answer">
  </div>
</div>

<div class="question-container">
  <div class="question">3. When will this program finish executing?</div>
  <div class="answer">
  </div>
</div>

<h1>LAB 7-3</h1>
<h3>For this lab, we obtained the malicious executable, Lab07-03.exe, and DLL, Lab07-03.dll, prior to executing. This is important to note because the mal- ware might change once it runs. Both files were found in the same directory on the victim machine. If you run the program, you should ensure that both files are in the same directory on the analysis machine. A visible IP string beginning with 127 (a loopback address) connects to the local machine. (In the real version of this malware, this address connects to a remote machine, but we’ve set it to connect to localhost to protect you.). Radare2 and IDA Pro will be used whenever it's suitable.</h3>

<i><b>WARNING</b> This lab may cause considerable damage to your computer and may be difficult to remove once installed. Do not run this file without a virtual machine with a snapshot taken prior to execution.</i><br>
<br>
This lab may be a bit more challenging than previous ones. You’ll need to use a combination of static and dynamic methods, and focus on the big picture in order to avoid getting bogged down by the details.

<div class="question-container">
  <div class="question">1. How does this program achieve persistence to ensure that it continues running when the computer is restarted?</div>
  <div class="answer">
  </div>
</div>

<div class="question-container">
  <div class="question">2. What are two good host-based signatures for this malware?</div>
  <div class="answer">
  </div>
</div>

<div class="question-container">
  <div class="question">3. What is the purpose of this program?</div>
  <div class="answer">
  </div>
</div>

<div class="question-container">
  <div class="question">4. How could you remove this malware once it is installed?</div>
  <div class="answer">
  </div>
</div>

<div class="question-container">
  <div class="question">3. template</div>
    <div class="answer">
        <pre class="brush: py;">
        ret = WININET.InternetGetConnectedState(0, 0, ecx)
        if (ret == 0):
            0x40105F(0x407030)
            return 0
        else:
            0x40105F(0x407048)
            return 1
        </pre>
        If you check the arguments for each function, you can see that they are pointing to different strings:<br>
        <br>
        <img class="centered_img" src="img/6-1.1.2.png"/>
        <br>
  </div>
</div>


<!-- Finally, to actually run the highlighter, you need to include this JS on your page -->
<script type="text/javascript">
  SyntaxHighlighter.defaults['smart-tabs'] = true;
  SyntaxHighlighter.defaults['highlight'] = [0, 0];
  SyntaxHighlighter.defaults['toolbar'] = false;
    SyntaxHighlighter.all()
</script>

</body>
</html>
