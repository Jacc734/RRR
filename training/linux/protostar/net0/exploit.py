#!/usr/bin/env python
#-*- coding: utf-8 -*-

import sys
import struct
import subprocess
import re

binary = '/opt/protostar/bin/net0'

HOST = '127.0.0.1'
PORT = 2999

import socket
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((HOST, PORT))
data = s.recv(1024)
print('[+] Received: {0}'.format(data))
number = int(data.split('\'')[1])
payload = socket.ntohl(number)
payload = struct.pack('<L', number)
payload = str(payload)
s.send(payload)
data = s.recv(1024)
s.close()
print('[+] Received: {0}'.format(data))

with open('payload', 'w') as fd1:
    fd1.write(payload)

