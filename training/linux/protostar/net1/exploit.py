#!/usr/bin/env python
#-*- coding: utf-8 -*-

import sys
import struct
import subprocess
import re

binary = '/opt/protostar/bin/net0'

HOST = '127.0.0.1'
PORT = 2998

import socket
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((HOST, PORT))
data = s.recv(1024)
hex_data = data.encode('hex')
print('[+] Received data (converted to hex): {0}'.format(hex_data))
payload = socket.htonl(int(hex_data, 16))
#payload = struct.pack('<L', int(hex_data, 16)) #don't know why this don't work!
payload = str(payload)
s.send(payload)
data = s.recv(1024)
s.close()
print('[+] Received: {0}'.format(data))

with open('payload', 'w') as fd1:
    fd1.write(payload)

